# -*- coding: utf-8 -*-
"""scrap -notaires.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1ePa6_T97Ir3SJNDULrtj9jXIQdgPx025
"""

import requests 
import json 
import time 
import pandas as pd
from bs4 import BeautifulSoup

pages = []
for i in range(1,49):
  page = requests.get("https://www.lespagesmaghreb.com/annuaire/algerie/notaires/1641f19",params={"page":str(i)})
  soup = BeautifulSoup(page.content, 'html.parser')
  firms_container = soup.find(class_="list-firms")
  pages.append(firms_container)
  time.sleep(1)



notaries = []
for page in pages:
  firms = page.find_all(class_="listing-body")
  firms = list(firms)
  for firm in firms :
    name = firm.find(class_="juridique-name").get_text()
    address = firm.find(class_='address-location').get_text()
    notaries.append({"nom":name,"adresse":address})


print(notaries)

df = pd.DataFrame.from_dict(notaries)

new = df['adresse'].str.split(",",2,expand = True)


df['adresse'] = new[0]

df['code']=new[1].str.extract(r"(\d+)")

df.nom.replace({r'(.*)(NOTAIRE)(\s|$)(.*)' : r'\1\4'}, regex=True,inplace=True)
df.nom.replace({r'(.*)(MAITRE)(\s|$)(.*)' : r'\1\4'}, regex=True,inplace=True)

df['fonction']= 'Notaire'


